<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Predictive Input Test</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      padding: 40px;
      max-width: 600px;
      width: 100%;
    }

    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 28px;
    }

    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }

    .test-section {
      margin-bottom: 30px;
    }

    .test-section h2 {
      color: #667eea;
      font-size: 18px;
      margin-bottom: 15px;
    }

    .result {
      background: #f8f9fa;
      border-left: 4px solid #667eea;
      padding: 15px;
      border-radius: 4px;
      margin-top: 15px;
    }

    .result h3 {
      color: #333;
      font-size: 14px;
      margin-bottom: 10px;
    }

    .result pre {
      background: #fff;
      padding: 10px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 12px;
    }

    .status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 15px;
    }

    .status.success {
      background: #d4edda;
      color: #155724;
    }

    .status.error {
      background: #f8d7da;
      color: #721c24;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="container">
      <h1>üß† Predictive Input Test</h1>
      <p class="subtitle">Testing @aivue/predictive-input package</p>

      <div class="test-section">
        <h2>üì¶ Package Import Test</h2>
        <div class="status" :class="importStatus">
          {{ importMessage }}
        </div>
        <div v-if="importSuccess" class="result">
          <h3>‚úÖ Successfully Imported:</h3>
          <pre>{{ importedComponents }}</pre>
        </div>
      </div>

      <div v-if="importSuccess" class="test-section">
        <h2>üéØ Component Test</h2>
        <predictive-input
          v-model="testText"
          :client="mockClient"
          placeholder="Type something to test predictions..."
          @prediction-selected="handlePrediction"
          @predictions-updated="handlePredictionsUpdate"
        />
        
        <div v-if="selectedPrediction" class="result">
          <h3>Selected Prediction:</h3>
          <pre>{{ JSON.stringify(selectedPrediction, null, 2) }}</pre>
        </div>

        <div v-if="latestPredictions.length > 0" class="result">
          <h3>Latest Predictions ({{ latestPredictions.length }}):</h3>
          <pre>{{ JSON.stringify(latestPredictions, null, 2) }}</pre>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    const { createApp, ref } = Vue;

    // Import the package
    let PredictiveInput, usePredictiveInput;
    let importSuccess = false;
    let importError = null;

    try {
      const module = await import('../packages/predictive-input/dist/index.mjs');
      PredictiveInput = module.PredictiveInput;
      usePredictiveInput = module.usePredictiveInput;
      importSuccess = true;
      console.log('‚úÖ Package imported successfully:', module);
    } catch (error) {
      importError = error;
      console.error('‚ùå Failed to import package:', error);
    }

    createApp({
      components: {
        PredictiveInput
      },
      setup() {
        const testText = ref('');
        const selectedPrediction = ref(null);
        const latestPredictions = ref([]);

        // Mock AI client for testing
        const mockClient = {
          chat: async (messages) => {
            // Simulate AI response
            return JSON.stringify([
              { text: "Hello, how are you?", confidence: 0.95, type: "completion" },
              { text: "Hello there!", confidence: 0.85, type: "suggestion" },
              { text: "Hi everyone", confidence: 0.75, type: "completion" }
            ]);
          }
        };

        const handlePrediction = (prediction) => {
          selectedPrediction.value = prediction;
          console.log('Prediction selected:', prediction);
        };

        const handlePredictionsUpdate = (predictions) => {
          latestPredictions.value = predictions;
          console.log('Predictions updated:', predictions);
        };

        return {
          testText,
          selectedPrediction,
          latestPredictions,
          mockClient,
          handlePrediction,
          handlePredictionsUpdate,
          importSuccess,
          importStatus: importSuccess ? 'success' : 'error',
          importMessage: importSuccess ? '‚úÖ Package Loaded Successfully' : '‚ùå Failed to Load Package',
          importedComponents: importSuccess ? 'PredictiveInput, usePredictiveInput' : 'None'
        };
      }
    }).mount('#app');
  </script>
</body>
</html>

